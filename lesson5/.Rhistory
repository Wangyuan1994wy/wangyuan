sjlabelled::zap_labels(cgss)
table(cgss$sex)
str(cgss$sex)
class(cgss$sex)
cgss <- foreign::read.spss("CGSS2003b.sav",to.data.frame = TRUE)
warning()
warnings()
cgss <- foreign::read.spss("CGSS2003b.sav",to.data.frame = TRUE)
warnings()
str(cgss)
cgss[cgss=="无填答/不回答"] <- NA
cgss[cgss=="不知道/说不清"] <- NA
cgss[cgss=="不适合"] <- NA
cgss[cgss=="不适用"] <- NA
droplevels(cgss)
cgss <- droplevels(cgss)
ggplot(data=cgss,aes(x=sex))+geom_bar() +theme(text=element_text(family="STKaiti"))
ggplot(data=cgss,aes(x=sex))+geom_bar()
ggplot(data=cgss,aes(x=sex))+geom_bar() +theme(text=element_text(family="Simsun"))
ggplot(data=cgss,aes(x=sex))+geom_bar() +theme(text=element_text(family="SimSun"))
cgss2003a <-haven::as_factor(cgss2003)
cgss2003b <-sjlabelled::zap_labels(cgss2003)
data(efc)
str(efc$e42dep)
x <- set_labels(
efc$e42dep,
labels = c("independent" = 1, "severe dependency" = 4)
)
table(x)
get_values(x)
str(x)
table(zap_labels(x))
get_values(zap_labels(x))
str(zap_labels(x))
table(zap_unlabelled(x))
table(sjlabelled::zap_labels(x))
table(zap_labels(x))
x1 <- labelled(1:5, c(good = 1, bad = 5))
x1
zap_labels(x1)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss==-3] <- NA
cgss2003[cgss==-2] <- NA
cgss2003[cgss==-1] <- NA
cgss2003 <-haven::drop_labels(cgss2003)
cgss2003 <-haven::drop.labels(cgss2003)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$sitetype)
cgss2003[cgss2003==-1] <- NA
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$sitetype)
sjmisc::to_label(cgss2003)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <- sjmisc::to_label(cgss2003)
str(cgss2003$sitetype)
table(cgss2003$commtype)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$sitetype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
str(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
str(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
str(cgss2003$sitetype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
table(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
table(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <- sjmisc::to_label(cgss2003,drop.na=TRUE)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
knitr::kable(cgss2003$commtype)
knitr::kable(table(cgss2003$commtype))
knitr::kable(count(cgss2003$commtype))
knitr::kable(as.data.frame(table(cgss2003$commtype)))
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-haven::drop_labels(cgss2003)
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
table(cgss2003$birth)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
str(cgss2003$birth)
attr(cgss2003$birth,"names")
attr(cgss2003$birth,"value.labels")
cgss2003 <-sjlabelled::drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
table(cgss2003$birth)
attr(cgss2003$birth,"value.labels")
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
attr(cgss2003$township,"value.labels")
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
knitr::kable(as.data.frame(table(cgss2003$commtype)))
cgss2003 <- read_sav("CGSS2003b.sav")
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003c<- read_spss("CGSS2003.sav",
option = "foreign",         # force to use foreign-package
enc = "gb2312",              # may be necessary
autoAttachVarLabels = TRUE) # attach variable labels
library("sjPlot", lib.loc="~/Library/R/3.3/library")
library("sjstats", lib.loc="~/Library/R/3.3/library")
install.packages(c("future", "sjstats", "tidyr"))
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
class(cgss2003$birth)
mutate(data=cgss2003,age=2003-birth)
dplyr::mutate(data=cgss2003,age=2003-birth)
age <-2003- cgss2003$birth
library(tidyverse)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(data=cgss2003
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(data=cgss2003,
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
tbl_df() %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
tbl_df()
class(cgss2003)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
class(cgss2003)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
library(tidyverse)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
table(cgss2003$age)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
plyr::summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE)
)
age_s
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
max = max(age, na.rm = TRUE)
)
class(cgss2003$age)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- as_factor(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
class(cgss2003$age)
cgss2003 <- haven::as_factor(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- haven::as_factor(cgss2003)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
class(names(cgss2003)
)
w <- which( sapply( cgss2003, class ) == 'labelled' )
cgss2003[w] <- lapply( cgss2003[w], function(x) as.numeric(as.character(x)))
age_s <- cgss2003%>%
mutate(age = 2003 - birth)%>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
library(haven)
cgss2013 <- read_dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gb2312")
View(cgss2013)
str(cgss2013)
View(cgss2013)
names(cgss2013)
str(cgss2013)
str(cgss2013$a4)
library(haven)
cgss2013 <- read_dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
View(cgss2013)
str(cgss2013)
cgss2013 <- read.dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
library(foreign)
cgss2013 <- read.dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
install.packages("readstata13", lib="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
install.packages("readstata13", lib="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(readstata13)
