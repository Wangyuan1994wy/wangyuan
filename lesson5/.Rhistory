str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
str(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
str(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
str(cgss2003$sitetype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
table(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
table(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
cgss2003 <- sjmisc::to_label(cgss2003,drop.na=TRUE)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
knitr::kable(cgss2003$commtype)
knitr::kable(table(cgss2003$commtype))
knitr::kable(count(cgss2003$commtype))
knitr::kable(as.data.frame(table(cgss2003$commtype)))
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-haven::drop_labels(cgss2003)
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
table(cgss2003$birth)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
str(cgss2003$birth)
attr(cgss2003$birth,"names")
attr(cgss2003$birth,"value.labels")
cgss2003 <-sjlabelled::drop_labels(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjlabelled::as_label(cgss2003)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
table(cgss2003$birth)
attr(cgss2003$birth,"value.labels")
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
attr(cgss2003$township,"value.labels")
cgss2003 <-drop_labels(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
table(cgss2003$commtype)
cgss2003 <- foreign::read.spss("CGSS2003b.sav",
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <-drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
knitr::kable(as.data.frame(table(cgss2003$commtype)))
cgss2003 <- read_sav("CGSS2003b.sav")
use.value.labels=FALSE,
to.data.frame = TRUE)
cgss2003c<- read_spss("CGSS2003.sav",
option = "foreign",         # force to use foreign-package
enc = "gb2312",              # may be necessary
autoAttachVarLabels = TRUE) # attach variable labels
library("sjPlot", lib.loc="~/Library/R/3.3/library")
library("sjstats", lib.loc="~/Library/R/3.3/library")
install.packages(c("future", "sjstats", "tidyr"))
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
class(cgss2003$birth)
mutate(data=cgss2003,age=2003-birth)
dplyr::mutate(data=cgss2003,age=2003-birth)
age <-2003- cgss2003$birth
library(tidyverse)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(data=cgss2003
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(data=cgss2003,
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
tbl_df() %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
tbl_df()
class(cgss2003)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
class(cgss2003)
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
library(tidyverse)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
table(cgss2003$age)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
plyr::summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE)
)
age_s
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE)
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
age_s <- cgss2003%>%
mutate(age = 2003 - birth) %>%
summarize(
min = min(age, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
max = max(age, na.rm = TRUE)
)
class(cgss2003$age)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- as_factor(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
class(cgss2003$age)
cgss2003 <- haven::as_factor(cgss2003)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- haven::as_factor(cgss2003)
cgss2003<- cgss2003 %>%
mutate(age = 2003 - birth)
cgss2003 <- read_sav("CGSS2003b.sav")
cgss2003[cgss2003==-1] <- NA
cgss2003[cgss2003==-2] <- NA
cgss2003[cgss2003==-3] <- NA
str(cgss2003$commtype)
cgss2003 <- sjlabelled::drop_labels(cgss2003)
str(cgss2003$commtype)
cgss2003 <- sjmisc::to_label(cgss2003)
class(names(cgss2003)
)
w <- which( sapply( cgss2003, class ) == 'labelled' )
cgss2003[w] <- lapply( cgss2003[w], function(x) as.numeric(as.character(x)))
age_s <- cgss2003%>%
mutate(age = 2003 - birth)%>%
summarize(
min = min(age, na.rm = TRUE),
q1 = quantile(age, 0.25, na.rm = TRUE),
median = quantile(age, 0.5, na.rm = TRUE),
q3 = quantile(age, 0.75, na.rm = TRUE),
max = max(age, na.rm = TRUE),
mean = mean(age, na.rm = TRUE),
sd = sd(age, na.rm = TRUE),
missing = sum(is.na(age))
)
library(haven)
cgss2013 <- read_dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gb2312")
View(cgss2013)
str(cgss2013)
View(cgss2013)
names(cgss2013)
str(cgss2013)
str(cgss2013$a4)
library(haven)
cgss2013 <- read_dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
View(cgss2013)
str(cgss2013)
cgss2013 <- read.dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
library(foreign)
cgss2013 <- read.dta("~/DATA/CGSS/2003-2013/cgss2013.dta",encoding="gbk")
install.packages("readstata13", lib="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
install.packages("readstata13", lib="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(readstata13)
library(haven)
cgss2003 <- read_dta("cgss2003.dta",encoding = "utf-8")
str(cgss2003$sitetype)
attr(cgss2003$sitetype,"label")
attr(cgss2003$sitetype,"labels")
x <- 1:10
x
attr(x,"dim") <- c(2,5)
x
library(haven)
cgss2003 <- read_dta("cgss2003.dta",encoding = "utf-8")
str(cgss2003$sitetype)
attr(cgss2003$sitetype,"label")
attr(cgss2003$sitetype,"labels")
library(tidyverse)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")  # spss7.0版数据
str(cgss2003$sitetype)
attr(cgss2003$sitetype,"label")
attr(cgss2003$sitetype,"labels")
library(tidyverse)
library(haven)
cgss2003 <- read_sav("CGSS2003b.sav")  # spss7.0版数据
str(cgss2003$sitetype)
attr(cgss2003$sitetype,"label")
attr(cgss2003$sitetype,"labels")
cgss2003 %>%  count(sitetype)
ggplot(cgss2003, aes(x=sitetype)) +
geom_bar() +
scale_x_discrete(drop=TRUE)
count(cgss2003$sitetype)
#if(!require(sjmisc)) install.packages("sjmisc")
if(!require(sjPlot)) install.packages("sjPlot")
sjt.frq(cgss2003$sitetype)
#if(!require(sjmisc)) install.packages("sjmisc")
if(!require(sjPlot)) install.packages("sjPlot")
sjt.frq(cgss2003$sitetype)
#if(!require(sjmisc)) install.packages("sjmisc")
if(!require(sjPlot)) install.packages("sjPlot")
sjt.frq(cgss2003$sitetype)
sjp.setTheme(theme.font ='STXihei' ) # STHeiti也可
sjp.setTheme(theme.font ='STXihei' ) # STHeiti也可
library(sjPlot)
sjp.setTheme(theme.font ='STXihei' ) # STHeiti也可
sjp.setTheme(theme.font ='STXihei' ) # STHeiti也可
sjp.setTheme(theme.font ='STXihei' ) # STHeiti也可
sjlabelled::get_labels(cgss2003$sitetype,include.values="n")
sjlabelled::set_labels(cgss2003$sitetype,
labels=c("不适合"="-3",
"无填答/不回答"="-2",
"不知道/说不清" = "-1",
"直辖市/省会城市的市区" = "1",
"地级市市区"  ="2",
"县城城区"="3" ,
"集镇" ="4" ))
cgss2003  %>%
filter(sitetype>0) %>%
select(sitetype) %>%
haven::as_factor() %>%
droplevels() %>%
sjplot(fun="frq",axis.title="调查地类型")
cgss2003 %>%
filter(sitetype>0) %>%
select(sitetype) %>%
haven::as_factor()%>%
droplevels()%>%
sjplot(fun="frq", axis.title=")
cgss2003  %>%
filter(sitetype>0) %>%
select(sitetype) %>%
haven::as_factor() %>%
droplevels() %>%
sjplot(fun="frq",axis.title="调查地类型")
cgss2003  %>%
select(sitetype) %>%
sjmisc::to_label(drop.levels=TRUE) %>%
sjplot(fun="frq",axis.title="调查地类型")
# 安装必要的包，运行一次即可
install.packages('data.table')
library(devtools)
intsall.packages('devtools')
install.packages('devtools')
# 安装必要的包，运行一次即可
install.packages('data.table')
library(devtools)
options(download.file.method = "wininet")
install_git("https://github.com/huashan/ezdf")
install_github('huashan/pander')
# 加载包
library(ezdf)
install.packages('ezdf')
library(ezdf)
install.packages('ezdf')
